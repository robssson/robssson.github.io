<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸŽ¯ Tomi Dart Club Liga JesieÅ„ 2025 - Statystyki</title>
    <h4>Ostatnia aktualizacja: 15/10/2025</h4>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding: 20px; background-color: #f9f9f9; }
        h1, h2 { text-align: center; margin-bottom: 20px; color: #2c3e50; }
        table th, table td { text-align: center; }
        .table-container { overflow-x: auto; margin-bottom: 50px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŽ¯ Tomi Dart Club Liga JesieÅ„ 2025 ðŸŽ¯</h1>
        <h2>Zestawienie wysokich zakoÅ„czeÅ„</h2>
        <div class="table-container">
            <table class="table table-striped table-bordered table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>Zawodnik</th>
                        <th>Liczba wysokich zakoÅ„czeÅ„</th>
                        <th>WartoÅ›ci zakoÅ„czeÅ„ (>=100)</th>
                    </tr>
                </thead>
                <tbody id="high-finishes-body"></tbody>
            </table>
        </div>

        <h2>Podsumowanie szybkich lotek</h2>
        <div class="table-container">
            <table class="table table-striped table-bordered table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>Zawodnik</th>
                        <th>Liczba szybkich lotek</th>
                        <th>Szybkie legi (<=18)</th>
                    </tr>
                </thead>
                <tbody id="fast-legs-body"></tbody>
            </table>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // --- WYSOKIE ZAKOÅƒCZENIA ---
        fetch('tournament_high_finishes.json')
            .then(resp => resp.json())
            .then(data => {
                const playerFinishes = {};
                data.forEach(match => {
                    const highFinishes = match.high_finishes || {};
                    for (const [player, finishes] of Object.entries(highFinishes)) {
                        if (finishes && finishes.length > 0) {
                            if (!playerFinishes[player]) playerFinishes[player] = [];
                            playerFinishes[player] = playerFinishes[player].concat(finishes);
                        }
                    }
                });

                const sortedPlayers = Object.entries(playerFinishes)
                    .sort((a,b) => b[1].length - a[1].length || a[0].localeCompare(b[0]));

                const tbody = document.getElementById('high-finishes-body');
                sortedPlayers.forEach(([player, finishes]) => {
                    finishes.sort((a,b) => a-b);
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${player}</td>
                        <td>${finishes.length}</td>
                        <td>${finishes.join(', ')}</td>
                    `;
                    tbody.appendChild(row);
                });
            })
            .catch(err => console.error('BÅ‚Ä…d wczytywania high finishes:', err));

        // --- SZYBKIE LOTKI ---
        fetch('tournament_fast_legs.json')
            .then(resp => resp.json())
            .then(data => {
                const fastTotal = {};
                const fastNumbers = {};

                data.forEach(match => {
                    const fastLegs = match.fast_legs || {};
                    for (const [player, legs] of Object.entries(fastLegs)) {
                        if (!legs || legs.length === 0) continue;
                        if (!fastTotal[player]) {
                            fastTotal[player] = 0;
                            fastNumbers[player] = [];
                        }
                        fastTotal[player] += legs.length;
                        fastNumbers[player] = fastNumbers[player].concat(legs);
                    }
                });

                const sortedPlayers = Object.keys(fastTotal)
                    .sort((a,b) => fastTotal[b] - fastTotal[a]);

                const tbody = document.getElementById('fast-legs-body');
                sortedPlayers.forEach(player => {
                    const legs = fastNumbers[player].sort((a,b)=>a-b);
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${player}</td>
                        <td>${fastTotal[player]}</td>
                        <td>${legs.join(', ')}</td>
                    `;
                    tbody.appendChild(row);
                });
            })
            .catch(err => console.error('BÅ‚Ä…d wczytywania fast legs:', err));
    </script>
</body>
</html>
